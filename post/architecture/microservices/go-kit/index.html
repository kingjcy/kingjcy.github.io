<!DOCTYPE html>

<html lang="zh-cn">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="author" content="fatedier">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="go-kit本身不是一个框架，而是一套微服务工具集, 它可以用来解决分布式系统开发中的大多数常见问题. 所以你可以专注于你的业务逻辑中.">
<meta property="og:url" content="https://kingjcy.github.io/"><meta property="og:type" content="article">
<meta property="og:title" content="Go Kit - kingjcy blog"><meta property="og:site_name" content="kingjcy blog">

<title>
    
    Go Kit
    
</title>

<link rel="stylesheet" href="/onlyone/onlyone.css">
<link rel="shortcut icon" href="/assets/favicon.ico">
<script src="/onlyone/onlyone.js"></script>
<link rel="alternate" type="application/rss+xml" title="RSS" href="/index.xml">
</head>
<body>


<div class="container">
    <header class="nav">
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/">kingjcy blog</a>
                </div>

                <div class="collapse navbar-collapse" id="navbar-collapse">
                    <ul class="nav navbar-nav">
                        <li><a href="/categories/技术文章/">技术文章</a></li>
                        <li><a href="/categories/读书笔记/">读书笔记</a></li>
                        <li><a href="/categories/人生感悟/">人生感悟</a></li>
                        <li><a href="/tags/">分类</a></li>
                        <li><a href="/about/">关于我</a></li>
                        <li>
                            <form method="get" style="padding: 8px" action="https://www.google.com/search" target="_blank">
                                <input type="hidden" name="sitesearch" value="kingjcy.github.io"/>
                                <input type="text" class="form-control" name="q" placeholder="Press enter to search">
                            </form>
                        </li>
                    </ul>

                </div>
            </div>
        </nav>
    </header>


<div class="row">
    <div class="col-md-8">
        <article class="post single">

            <header>
                <div class="post-date">
                    2018年09月15日 
                </div>
                <h1 class="post-title">Go Kit</h1>
            </header>

            <div class="post-content">
                <p>go-kit本身不是一个框架，而是一套微服务工具集, 它可以用来解决分布式系统开发中的大多数常见问题. 所以你可以专注于你的业务逻辑中.</p>

<p>go-kit 入门</p>

<ol>
<li>microservice</li>
</ol>

<p>Go-Kit</p>

<p>go kit 是一个分布式的开发工具集，在大型的组织（业务）中可以用来构建微服务。其解决了分布式系统中的大多数常见问题，因此，使用者可以将精力集中在业务逻辑上。</p>

<ol>
<li>go-kit 组件介绍</li>
</ol>

<p>2.1 Endpoint（端点）</p>

<p>Go kit首先解决了RPC消息模式。其使用了一个抽象的 endpoint 来为每一个RPC建立模型。</p>

<p>endpoint通过被一个server进行实现（implement），或是被一个client调用。这是很多 Go kit组件的基本构建代码块。</p>

<p>2.2 Circuit breaker（回路断路器）</p>

<p>Circuitbreaker（回路断路器）</p>

<p>模块提供了很多流行的回路断路lib的端点（endpoint）适配器。回路断路器可以避免雪崩，并且提高了针对间歇性错误的弹性。每一个client的端点都应该封装（wrapped）在回路断路器中。</p>

<p>2.3 Rate limiter（限流器）</p>

<p>ratelimit模块提供了到限流器代码包的端点适配器。限流器对服务端（server-client）和客户端（client-side）同等生效。使用限流器可以强制进、出请求量在阈值上限以下。</p>

<p>2.4 Transport（传输层）</p>

<p>transport 模块提供了将特定的序列化算法绑定到端点的辅助方法。当前，Go kit只针对JSON和HTTP提供了辅助方法。如果你的组织使用完整功能的传输层，典型的方案是使用Go在传输层提供的函数库，Go kit并不需要来做太多的事情。这些情况，可以查阅代码例子来理解如何为你的端点写一个适配器。目前，可以查看 addsvc的代码来理解Transport绑定是如何工作的。我们还提供了针对Thirft,gRPC,net/rpc,和http json的特殊例子。对JSON/RPC和Swagger的支持在计划中。</p>

<p>2.5 Logging（日志）</p>

<p>服务产生的日志是会被延迟消费（使用）的，或者是人或者是机器（来使用）。人可能会对调试错误、跟踪特殊的请求感兴趣。机器可能会对统计那些有趣的事件，或是对离线处理的结果进行聚合。这两种情况，日志消息的结构化和可操作性是很重要的。Go kit的log 模块针对这些实践提供了最好的设计。</p>

<p>2.6 Metrics（Instrumentation）度量/仪表盘</p>

<p>直到服务经过了跟踪计数、延迟、健康状况和其他的周期性的或针对每个请求信息的仪表盘化，才能被认为是“生产环境”完备的。Go kit 的 metric 模块为你的服务提供了通用并健壮的接口集合。可以绑定到常用的后端服务，比如 expvar 、statsd、Prometheus。</p>

<p>2.7 Request tracing（请求跟踪）</p>

<p>随着你的基础设施的增长，能够跟踪一个请求变得越来越重要，因为它可以在多个服务中进行穿梭并回到用户。Go kit的 tracing 模块提供了为端点和传输的增强性的绑定功能，以捕捉关于请求的信息，并把它们发送到跟踪系统中。（当前支持 Zipkin，计划支持Appdash</p>

<p>2.8 Service discovery and load balancing（服务发现和负载均衡）</p>

<p>如果你的服务调用了其他的服务，需要知道如何找到它（另一个服务），并且应该智能的将负载在这些发现的实例上铺开（即，让被发现的实例智能的分担服务压力）。Go kit的
loadbalancer模块提供了客户端端点的中间件来解决这类问题，无论你是使用的静态的主机名还是IP地址，或是 DNS的 SRV 记录，Consul，etcd 或是 Zookeeper。并且，如果你使用定制的系统，也可以非常容易的编写你自己的 Publisher，以使用 Go kit 提供的负载均衡策略。（目前，支持静态主机名、etcd、Consul、Zookeeper）</p>

<p>3 目标</p>

<pre><code>在各种SOA架构中操作–预期会与各种非Go kit服务进行交互
使用RPC作为最主要的消息模式
可插拔的序列化和传输–不仅仅只有JSON和HTTP
简单便可融入现有的架构–没有任何特殊工具、技术的相关指令
</code></pre>

<p>4 目标之外（不考虑做的事情）</p>

<pre><code>支持除RPC之外的消息模式（至少目前是）–比如 MPI、pub/sub，CQRS，等
除适配现有软件外，重新实现一些功能
在运维方面进行评论：部署、配置、进程管理、服务编排等
</code></pre>

<p>5 依赖管理</p>

<p>Go kit 是一个函数库，设计的目标是引入到二进制文件中。对于二进制软件包的作者来讲，Vendoring是目前用来确保软件可靠、可重新构建的最好的机制。因此，我们强烈的建议我们的用户使用vendoring机制来管理他们软件的依赖，包括Go kit。</p>

<p>为了避免兼容性和可用性的问题，Go kit没有vendor它自己的依赖，并且并不推荐使用第三方的引用代理。</p>

<p>有一些工具可以让vendor机制更简单，包括 gb、glide、gvt、govendor 和 vendetta。另外，Go kit使用了一系列的持续集成的机制来确保在尽快地修复那些复杂问题。</p>

<p>5 相关项目</p>

<p>标注有 ★ 的项目对 Go kit 的设计有着特别的影响 （反之亦然）</p>

<pre><code>服务框架

gizmo, a microservice toolkit from The New York Times ★
go-micro, a microservices client/server library ★
gocircuit, dynamic cloud orchestration
gotalk, async peer communication protocol &amp; library
h2, a microservices framework ★
Kite, a micro-service framework
</code></pre>

<p>独立组件</p>

<pre><code>afex/hystrix-go, client-side latency and fault tolerance library

armon/go-metrics, library for exporting performance and runtime metrics to external metrics systems

codahale/lunk, structured logging in the style of Google’s Dapper or Twitter’s Zipkin

eapache/go-resiliency, resiliency patterns

sasbury/logging, a tagged style of logging

grpc/grpc-go, HTTP/2 based RPC

inconshreveable/log15, simple, powerful logging for Go ★

mailgun/vulcand, programmatic load balancer backed by etcd

mattheath/phosphor, distributed system tracing

pivotal-golang/lager, an opinionated logging library

rubyist/circuitbreaker, circuit breaker library

Sirupsen/logrus, structured, pluggable logging for Go ★

sourcegraph/appdash, application tracing system based on Google’s Dapper

spacemonkeygo/monitor, data collection, monitoring, instrumentation, and Zipkin client library

streadway/handy, net/http handler filters

vitess/rpcplus, package rpc + context.Context

gdamore/mangos, nanomsg implementation in pure Go
</code></pre>

<p>Web 框架</p>

<pre><code>Beego

Gin

Goji

Gorilla

Martini

Negroni

Revel (considered harmful)
</code></pre>

<p>其他参考</p>

<pre><code>Architecting for the Cloud — Netflix

Dapper, a Large-Scale Distributed Systems Tracing Infrastructure— Google

Your Server as a Function (PDF) — Twitter
</code></pre>
            </div>
            
            <div style="border: 1px dashed #e0e0e0; margin-bottom: 15px; padding: 10px 10px 10px 10px; background-color: #fffeee; background-repeat: no-repeat; background-attachment: scroll; background-position: 1% 50%; -moz-background-size: auto auto; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
                <div>
                    <p style="margin-top:0px;">作者：<a target="_blank" href="http://blog.fatedier.com/">kingjcy</a>
                    <br />本文出处：<a target="_blank" href="https://kingjcy.github.io/post/architecture/microservices/go-kit/">https://kingjcy.github.io/post/architecture/microservices/go-kit/</a>
                    <br />
                    文章版权归本人所有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文链接，否则保留追究法律责任的权利。 </p>
                </div>
            </div>

            <aside>
                
                <ul class="list-inline post-tags">
                    
                    <li>
                        <a href="/tags/go-kit/">
                            <i class="fa fa-tags"></i>
                            Go Kit
                        </a>
                    </li>
                    
                </ul>

                
                
                <h4 id="real-rels">相关文章</h4>
                <ul class="post-rels" id="real-rels"></ul>
            </aside>
                
            
            <footer>
                <nav>
                    <ul class="pager">

                        
                        <li class="previous"><a href="/post/golang/go-net-http-pporf/"><span aria-hidden="true">&larr;</span> Prev</a></li>
                        

                        <li><a href="/post/">All Posts</a></li>

                        
                        <li class="next"><a href="/post/worklife/myidea/">Next <span aria-hidden="true">&rarr;</span></a></li>
                        

                    </ul>
                </nav>
            </footer>

        </article>
    </div>
    <div class="col-md-4">
        
<aside>
        <div class="toc panel panel-default hidden-xs hidden-sm affix-top" data-spy="affix" data-offset-top="125" data-offset-bottom="300">
            <div class="panel-heading">
                <h2 class="panel-title">Catalog</h2>
            </div>

            
        </div>
</aside>

    </div>
</div>

</div>
<hr>

<footer class="container copy">
    <p>&copy; 2020  kingjcy blog </p>
	<p>Powered by <a href="https://gohugo.io" target="_blank">Hugo</a></p>
</footer>

<script>hljs.initHighlightingOnLoad();</script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?ace3ec99de96c4080ead1eb8d52db3b3";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-92600390-2', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>

