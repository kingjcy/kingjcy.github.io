<!DOCTYPE html>

<html lang="zh-cn">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="author" content="fatedier">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="这边主要是记录在使用mac os中的一些常用的东西。mac os和linux有这个很多相同的东西，可以互相学习">
<meta property="og:url" content="https://kingjcy.github.io/"><meta property="og:type" content="article">
<meta property="og:title" content="Mac - kingjcy blog"><meta property="og:site_name" content="kingjcy blog">

<title>
    
    Mac
    
</title>

<link rel="stylesheet" href="/onlyone/onlyone.css">
<link rel="shortcut icon" href="/assets/favicon.ico">
<script src="/onlyone/onlyone.js"></script>
<link rel="alternate" type="application/rss+xml" title="RSS" href="/index.xml">
</head>
<body>


<div class="container">
    <header class="nav">
        <nav class="navbar navbar-default">
            <div class="container-fluid">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="/">kingjcy blog</a>
                </div>

                <div class="collapse navbar-collapse" id="navbar-collapse">
                    <ul class="nav navbar-nav">
                        <li><a href="/categories/技术文章/">技术文章</a></li>
                        <li><a href="/categories/读书笔记/">读书笔记</a></li>
                        <li><a href="/categories/人生感悟/">人生感悟</a></li>
                        <li><a href="/tags/">分类</a></li>
                        <li><a href="/about/">关于我</a></li>
                        <li>
                            <form method="get" style="padding: 8px" action="https://www.google.com/search" target="_blank">
                                <input type="hidden" name="sitesearch" value="kingjcy.github.io"/>
                                <input type="text" class="form-control" name="q" placeholder="Press enter to search">
                            </form>
                        </li>
                    </ul>

                </div>
            </div>
        </nav>
    </header>


<div class="row">
    <div class="col-md-8">
        <article class="post single">

            <header>
                <div class="post-date">
                    2017年05月21日 
                </div>
                <h1 class="post-title">Mac</h1>
            </header>

            <div class="post-content">
                <p>这边主要是记录在使用mac os中的一些常用的东西。mac os和linux有这个很多相同的东西，可以互相学习</p>

<ol>
<li><p>界面安装软件必须要加入到应用程序中才能和mac os系统中的环境变量一致，liteide的环境变量设置由于没有加入(直接图标拖入应用程序就好)到应用程序中导致环境变量一直无法修改，折腾了好半天才发现。</p></li>

<li><p>brew很重要，类似于linux中的yum，rpm。</p></li>

<li><p>mac 在终端如何进入名称带空格的目录</p>

<ol>
<li><p>cd Appications/Android\Studio.app/sdk</p></li>

<li><p>cd Appications/Android&rsquo; &lsquo;Studio.app/sdk</p></li>

<li><p>cd Appications/Android&rdquo; &ldquo;Studio.app/sdk</p></li>
</ol></li>

<li><p>iterm2使用代理
export http_proxy=<a href="http://10.49.3.148:1080">http://10.49.3.148:1080</a>
export https_proxy=<a href="http://10.49.3.148:1080">http://10.49.3.148:1080</a></p></li>

<li><p>mac切root</p></li>
</ol>

<p>sudo -i或者sudo su</p>

<ol>
<li><p>dockerhub的镜像元下载会非常之慢，我们需要首先切换镜像元，还好国内有家叫DaoCloud的公司帮我们免费解决了这个问题</p></li>

<li><p>go的环境变量</p>

<pre><code>export GOARCH=&quot;amd64&quot;
export GOBIN=&quot;&quot;
export GOCACHE=&quot;/Users/chunyinjiang/Library/Caches/go-build&quot;
export GOEXE=&quot;&quot;
export GOHOSTARCH=&quot;amd64&quot;
export GOHOSTOS=&quot;darwin&quot;
export GOOS=&quot;linux&quot;
export GOPATH=&quot;/Users/chunyinjiang/jcy/work/go_workspace/nvidia_gpu_prometheus_exporter&quot;
export GORACE=&quot;&quot;
export GOROOT=&quot;/usr/local/Cellar/go/1.10/libexec&quot;
export GOTMPDIR=&quot;&quot;
export GOTOOLDIR=&quot;/usr/local/Cellar/go/1.10/libexec/pkg/tool/darwin_amd64&quot;
export GCCGO=&quot;gccgo&quot;
export CC=&quot;clang&quot;
export CXX=&quot;clang++&quot;
export CGO_ENABLED=&quot;0&quot;
export CGO_CFLAGS=&quot;-g -O2&quot;
export CGO_CPPFLAGS=&quot;&quot;
export CGO_CXXFLAGS=&quot;-g -O2&quot;
export CGO_FFLAGS=&quot;-g -O2&quot;
export CGO_LDFLAGS=&quot;-g -O2&quot;
export PKG_CONFIG=&quot;pkg-config&quot;
export GOGCCFLAGS=&quot;-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/0x/2p33j4jn12d607lyq25sqxhr0000gn/T/go-build970193849=/tmp/go-build -gno-record-gcc-switches&quot;
</code></pre></li>

<li><p>mac的钥匙串访问，可以看到所有的记住的密码。</p></li>

<li><p>iterm2中脚本密码出现特殊字符比如-，[]这些，需要使用转义字符才能保证正常登陆，比如／-</p></li>

<li><p>iterm2设置脚本登陆</p>

<pre><code>#!/usr/bin/expect -f
set user root
set host 10.47.212.61
set password -sSp\Te85
set timeout -1

spawn ssh $user@$host
expect &quot;*assword:*&quot;
send &quot;$password\r&quot;
interact
expect eof
</code></pre>

<ol>
<li><p>send_user 是回显，相当于echo。</p></li>

<li><p>spawn 是开启新的进程</p></li>

<li><p>expect{  } 这是匹配上一条指令的输出，，比如上面spawn 那句执行完后，会提示你输入密码，提示语中会包含 password，因此就匹配*assword*，然后就send &ndash; $password 把密码发过去。</p></li>

<li><p>send 就是发指令到对端</p></li>

<li><p>expect 内部有个exp_continue ，意思是重新匹配所在的expect，相当于while的continue</p></li>

<li><p>expect 的 -re 表示匹配正则表达式</p></li>
</ol></li>

<li><p>vmbox虚拟机迁移</p>

<p>目标：</p>

<pre><code>虚拟机硬盘路径从
/Volumes/exFat/XP/XP-30G.vdi
到
/Volumes/exFat2/XP/XP-30G.vdi
</code></pre>

<p>错误：</p>

<pre><code>Cannot register the hard disk '/Volumes/exFat2/XP/XP-30G.vdi' {c547a9be-4373-4a4a-a0cf-3a6dbb606908} because a hard disk '/Volumes/exFat/XP/XP-30G.vdi' with UUID {c547a9be-4373-4a4a-a0cf-3a6dbb606908} already exists.
</code></pre>

<p>返回 代码: </p>

<pre><code>NS_ERROR_INVALID_ARG (0x80070057)
</code></pre>

<p>组件:</p>

<pre><code>VirtualBoxWrap
</code></pre>

<p>界面:</p>

<pre><code>IVirtualBox {0169423f-46b4-cde9-91af-1e9d5b6cd945}
</code></pre>

<p>被召者 RC:</p>

<pre><code>VBOX_E_OBJECT_NOT_FOUND (0x80BB0001)
</code></pre>

<p>解决办法（OSX/Linux）：</p>

<pre><code>0.关闭VirtualBox
1.复制虚拟机文件到其他地方（一般是从/Users/{你的用户名}/VirtualBox VMs/{虚拟机名称}/）
2.打开命令行Terminal 
3.输入命令：(如下图)
1）cd /Applications/VirtualBox.app/Contents/MacOS
2）VBoxManage internalcommands sethduuid /Volumes/exFat2/XP/XP-30G.vdi
［注意命令2的路径是你的新的目标路径］
你会看到UUID被修改后的结果:UUID changed to: 77590535-9162-4b2d-8032-11c312042814
4.重新打开VirtualBox
5.对着指定虚拟机右键，设置，存储，控制器：IDE，点击列表中的.vdi文件，找到右边虚拟硬盘一行的最右边图标，点击，选择一个虚拟硬盘，修改确定即可，同时修改备份路径
6.保存，启动虚拟机
</code></pre></li>

<li><p>lsof</p>

<p>水果系统内核是有 BSD 血统的 Darwin，OS X 自带的很多 CLI 工具也是 BSD style 的，有一部分使用起来和 Linux 无异，有一部分可以通过 brew 安装 GNU 版本（如 tar），但是 OS X 的 netstat 不能查看使用端口的程序名让我一直很不爽，而且也没找到 GNU 版本，于是去搜了一下解决办法，stackoverflow 上的结论基本都是建议使用 lsof 代替 netstat 进行查看：</p>

<p>sudo lsof -nP -iTCP:端口号 -sTCP:LISTEN
-n 表示不显示主机名
-P 表示不显示端口俗称
不加 sudo 只能查看以当前用户运行的程序
另外，还可以通过管道来过滤想要的信息</p>

<p>sudo lsof -nP -iTCP -sTCP:LISTEN | grep python</p>

<p>例如</p>

<p>所以你可以使用下面的命令：</p>

<pre><code>lsof -n -i4TCP:$PORT | grep LISTEN # Verified on macOS Sierra
lsof -n -iTCP:$PORT | grep LISTEN
lsof -n -i:$PORT | grep LISTEN
</code></pre>

<p>为了不显示端口的俗称，你可以加P参数：</p>

<pre><code>lsof -nP -i4TCP:$PORT | grep LISTEN # Verified on macOS Sierra
lsof -nP -iTCP:$PORT | grep LISTEN
lsof -nP -i:$PORT | grep LISTEN
</code></pre></li>

<li><p>shell切换</p>

<p>从 bash 切换回 zsh</p>

<pre><code>sudo chsh -s /bin/zsh
</code></pre>

<p>从 zsh 切换回 bash</p>

<pre><code>sudo chsh -s /bin/bash
</code></pre></li>

<li><p>combile</p>

<p>升级到Catalina 10.15后，golang编译完成后，执行二进制文件报错：
dyld: malformed mach-o image: segment __DWARF has vmsize &lt; filesize</p>

<p>目前解决办法，去掉DWARF调试信息：
编译的时候使用 go build -ldflags &ldquo;-w&rdquo; 这种方式编译。
-ldflags： 表示将后面的参数传给连接器（5/6/8l）
-s：去掉符号信息
-w：去掉DWARF调试信息
注意：
-w 去掉DWARF调试信息，得到的程序就不能用gdb调试了</p></li>

<li><p>Mac设置开机启动</p>

<p>本文针对命令行使用的开发工具或自己编写的脚本设置开机启动，图形化界面的程序仅需要设置-&gt;用户与群组-&gt;登录项中即可配置。</p>

<p>相比于Linux开机启动设置的简单方便&ndash;配置rc.local文件即可，mac设置开机启动略显麻烦。</p>

<p>如果是使用homebrew安装软件自然不用考虑开机启动这回事，但有时候想执行自己的脚本或者有特殊需求，就不得不自己处理开机启动了。</p>

<ol>
<li>使用登录项添加可执行脚本（推荐）
在用户的家目录编写一个sh脚本，例如：</li>
</ol>

<p>test.sh</p>

<p>#!/bin/bash</p>

<p>在用户的家目录创建一个文件
touch ~/haha.txt
添加可执行权限</p>

<p>chmod 755 test.sh
进入设置-&gt;用户与群组-&gt;登录项，点+号，选择test.sh文件即可。</p>

<p>重启电脑，验证是否新建了文件，如存在说明配置成功，修改该文件内容为你想要的配置。</p>

<p>该文件将会在开机时执行，可在命令行中执行的开机启动项均可在此文件中配置。</p>

<p>PS: 开机后会显示一个“进程已结束”的终端，不太爽，需要进入终端的偏好设置-&gt;shell选项卡-&gt;当shell退出时, 选择“关闭窗口”。这样开机时就不会出现一个终端了</p>

<p>在 macOS Sierra及以上(Mojave)，我们可以使用快捷键 ⌘⇧.(Command + Shift + .) 来快速（在 Finder 中）显示和隐藏隐藏文件了。</p></li>

<li><p>别名</p>

<p>alias l=&lsquo;ls -l&rsquo;
alias l.=&lsquo;ls -d .*&rsquo;
alias ll=&lsquo;ls -l&rsquo;
alias ls=&lsquo;ls&rsquo;
alias vi=&lsquo;vim&rsquo;
alias gs=&lsquo;cd /Users/chunyinjiang/jcy/work/go_workspace/go_path&rsquo;</p>

<p>export M3_HOME=/Users/chunyinjiang/jcy/apache-maven-3.3.9
PATH=$M3_HOME/bin:$PATH</p></li>

<li><p>xcrun: error: invalid active developer path (/Library/Developer/CommandLineTools), missing xcrun at: /Library/Developer/CommandLineTools/usr/bin/xcrun</p>

<p>需要安装xcode</p>

<pre><code>Go back to your terminal and hit:

xcode-select --install
</code></pre></li>

<li><p>解决因更改个人文件夹中项目的权限而导致的问题</p>

<p>1.重设权限
    如果问题是在更改个人文件夹中项目的权限后开始出现的，请使用以下步骤重设权限。</p>

<pre><code>从“访达”菜单栏中，选取“前往”&gt;“个人”。您的个人文件夹将打开。
选取“文件”&gt;“显示简介”。您的个人文件夹的“简介”窗口将打开。
如果窗口底部的“共享与权限”部分没有打开，请点按这个部分中的三角形  以将它打开。
如果窗口底部的“锁定”按钮是闭合的 锁,请点按该锁，然后输入管理员用户名和密码。
点按窗口底部的“操作”菜单 ，然后选取“应用到包含的项目”。点按“好”以确认这项操作。此时窗口顶部会显示一个进度条。

在进度条完成后，打开“终端”应用，它位于“应用程序”文件夹的“实用工具”文件夹中。
在“终端”中粘贴或键入 diskutil resetUserPermissions / `id -u`，然后按 Return 键。
在美式键盘上，字符“`”位于 Tab 键的正上方。
如果“终端”显示权限重设失败，请跳至下一部分。
在这个过程完成后，重新启动 Mac。
</code></pre>

<p>2.如果“终端”显示权限重设失败
    执行上述步骤时，如果收到用户个人目录上权限重设失败的信息（错误 -69841），请按照以下步骤操作。</p>

<pre><code>如果您的 Mac 使用的是 macOS Mojave
退出“终端”。
选取苹果菜单  &gt;“系统偏好设置”,点按“安全性与隐私”,然后点按“隐私”。
点按锁形图标 ，然后输入您的管理员密码。
从左侧的项目列表中，选择“完全磁盘访问权限”。
将“终端”添加到允许完全磁盘访问的应用中：使用添加按钮 ，或者只将“终端”应用拖移到其上方的区域中。
打开“终端”，然后输入 chflags -R nouchg ~。
再次输入 diskutil resetUserPermissions / `id -u`。
在这个过程完成后，重新启动 Mac。
选取苹果菜单  &gt;“系统偏好设置”,点按“安全性与隐私”,然后点按“隐私”。
点按锁形图标 ，然后输入您的管理员密码。
从左侧的项目列表中，选择“完全磁盘访问权限”。
您现在可以从允许完全磁盘访问的应用中移除“终端”，或者只需取消选中“终端”旁的复选框即可。
</code></pre>

<p>3.如果您的 Mac 使用的是 macOS High Sierra 或更低版本</p>

<pre><code>输入 chflags -R nouchg ~。
再次输入 diskutil resetUserPermissions / `id -u`。
在这个过程完成后，重新启动 Mac。
</code></pre></li>

<li><p>vmbox不支持换电脑进行转换，但是并行桌面就可以直接拷贝文件，在不同电脑上进行运行。</p></li>

<li><p>修改mac地址</p>

<p>当某个环境下，只能指定网卡上网时，这个方法你就爽歪歪了</p>

<pre><code>networksetup -listallhardwareports 查看当前所有端口Mac地址

sudo ifconfig en1 ether e4:ce:8f:32:51:82 修改
</code></pre>

<p>en1是WiFi标记 e4:ce:8f:32:51:82 是目标Mac地址</p>

<pre><code>ifconfig en1 | grep ether 查看是否修改成功
</code></pre>

<p>电脑重启mac地址复原</p></li>

<li><p>恢复出厂设置，其实就是重装系统。</p>

<p>准备</p>

<pre><code>1、安装Mac OS系统的苹果电脑。

2、重置出厂系统将会清空硬盘数据，提前转移和备份硬盘中的重要文件。

3、保持WIFI连接。
</code></pre>

<p>具体恢复操作步骤如下：</p>

<pre><code>1/ 按下键盘组合键（option + command + R或 command + R），然后按Macbook的电源键开机，启动Mac的OS X的实用工具。

    开机后立即按下Option ，将显示启动管理器，如果Mac装有双系统或者插有启动U盘，可在启动管理器中选择启动盘　　

    开机后立即按下Command-R ，可打开OS X的恢复功能（Recovery）　　

    开机后立即按下Command-Option-P-R ，重置NVRAM（ Non-Volatile Random Access Memory） 是非易失性随机访问存储器，指断电后仍能保持数据的一种RAM。

    有些时候电脑会出现些小问题，重置NVRAM是你除了重新启动，尝试修复的第一选择。　

2/ 出现MacOS实用工具对话框，选择第四个&quot;磁盘工具&quot;,点击继续按钮。


3/ 紧接着就会弹出如下的界面，在左侧选择内置主硬盘名称（一般为Macintosh HD，具体名称依电脑而异），接着选择&quot;抹掉&quot;，等待抹掉成功的提示，抹掉操作如下图所示：


4/ 抹掉成功后，关闭对话框，返回到MacOS实用工具页面，并选择&quot;重新安装MacOS&quot;，如下图所示：


5/ 重新安装时，必须保证wifi的正常有效，根据提示一步步操作就可以了。待安装完成后，后续的设置就相当于新电脑初始使用时的设置一样，包括键盘识别、语言设置、appleID设置和帐户密码设置等。

6/ 整个安装的过程可能会持续数小时左右，需耐心等待，请务必接通电源后再进行！
</code></pre></li>

<li><p>现象：旧mac中的office的文件导入后就被锁定，不能编辑。&mdash;word未激活。</p></li>
</ol>
            </div>
            
            <div style="border: 1px dashed #e0e0e0; margin-bottom: 15px; padding: 10px 10px 10px 10px; background-color: #fffeee; background-repeat: no-repeat; background-attachment: scroll; background-position: 1% 50%; -moz-background-size: auto auto; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial;">
                <div>
                    <p style="margin-top:0px;">作者：<a target="_blank" href="http://blog.fatedier.com/">kingjcy</a>
                    <br />本文出处：<a target="_blank" href="https://kingjcy.github.io/post/application/mac/">https://kingjcy.github.io/post/application/mac/</a>
                    <br />
                    文章版权归本人所有，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文链接，否则保留追究法律责任的权利。 </p>
                </div>
            </div>

            <aside>
                
                <ul class="list-inline post-tags">
                    
                    <li>
                        <a href="/tags/mac/">
                            <i class="fa fa-tags"></i>
                            mac
                        </a>
                    </li>
                    
                    <li>
                        <a href="/tags/osx/">
                            <i class="fa fa-tags"></i>
                            osx
                        </a>
                    </li>
                    
                </ul>

                
                
                <h4 id="real-rels">相关文章</h4>
                <ul class="post-rels" id="real-rels"></ul>
            </aside>
                
            
            <footer>
                <nav>
                    <ul class="pager">

                        
                        <li class="previous"><a href="/post/web/language/typescript/"><span aria-hidden="true">&larr;</span> Prev</a></li>
                        

                        <li><a href="/post/">All Posts</a></li>

                        
                        <li class="next"><a href="/post/language/ruby/">Next <span aria-hidden="true">&rarr;</span></a></li>
                        

                    </ul>
                </nav>
            </footer>

        </article>
    </div>
    <div class="col-md-4">
        
<aside>
        <div class="toc panel panel-default hidden-xs hidden-sm affix-top" data-spy="affix" data-offset-top="125" data-offset-bottom="300">
            <div class="panel-heading">
                <h2 class="panel-title">Catalog</h2>
            </div>

            
        </div>
</aside>

    </div>
</div>

</div>
<hr>

<footer class="container copy">
    <p>&copy; 2020  kingjcy blog </p>
	<p>Powered by <a href="https://gohugo.io" target="_blank">Hugo</a></p>
</footer>

<script>hljs.initHighlightingOnLoad();</script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?ace3ec99de96c4080ead1eb8d52db3b3";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-92600390-2', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>

